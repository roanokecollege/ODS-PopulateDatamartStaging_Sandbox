<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="12/3/2013 3:40:30 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="SANDBOX"
  DTS:CreatorName="ACADEMIC\webserv"
  DTS:DTSID="{E9DDAEBF-C06F-4094-ADC5-7892D0536292}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="14.0.3026.27"
  DTS:LocaleID="1033"
  DTS:ObjectName="StudentAddressImport"
  DTS:PackageType="5"
  DTS:VersionBuild="8"
  DTS:VersionGUID="{06BD658B-4233-4466-8B72-81CB46411405}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[localhost.Staging]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{101FB509-069B-4917-A8F6-460109941DEC}"
      DTS:ObjectName="localhost.Staging">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=localhost;Initial Catalog=Staging;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;Application Name=SSIS-StudentAddressImport-{101FB509-069B-4917-A8F6-460109941DEC}localhost.Staging;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[mail server]"
      DTS:CreationName="SMTP"
      DTS:DTSID="{AA490B9E-F51F-4E17-8A18-A6D2C783AD87}"
      DTS:ObjectName="mail server">
      <DTS:ObjectData>
        <SmtpConnectionManager
          ConnectionString="SmtpServer=199.111.154.146;UseWindowsAuthentication=True;EnableSsl=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Home Address Merge Error Notification"
      DTS:CreationName="Microsoft.SendMailTask"
      DTS:Description="Send Mail Task"
      DTS:DTSID="{AD0313ED-3BC8-4C37-B334-ADF457D57A00}"
      DTS:ExecutableType="Microsoft.SendMailTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Home Address Merge Error Notification"
      DTS:TaskContact="Send Mail Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="2">
      <DTS:Variables />
      <DTS:ObjectData>
        <SendMailTask:SendMailTaskData
          SendMailTask:SMTPServer="{AA490B9E-F51F-4E17-8A18-A6D2C783AD87}"
          SendMailTask:From="noreply@roanoke.edu"
          SendMailTask:To="datamart@roanoke.edu"
          SendMailTask:CC="gabrielson@roanoke.edu"
          SendMailTask:Subject="Student Home Address Import Failure Hermes"
          SendMailTask:Priority="High"
          SendMailTask:MessageSource="Task:&#xA;&#xA;Merge Home Address &#xA;&#xA;in package StudentAddressImport located at &#xA;&#xA;StudentAddressImport.dtsx &#xA;&#xA;has failed.&#xA;&#xA;The import of student data into the datamart will continue.&#xA;&#xA;This step needs to be re-executed." xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Local Address Merge Error Notification"
      DTS:CreationName="Microsoft.SendMailTask"
      DTS:Description="Send Mail Task"
      DTS:DTSID="{B093EC07-A9F5-42C9-B756-98CAA938EC2C}"
      DTS:ExecutableType="Microsoft.SendMailTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Local Address Merge Error Notification"
      DTS:TaskContact="Send Mail Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SendMailTask:SendMailTaskData
          SendMailTask:SMTPServer="{AA490B9E-F51F-4E17-8A18-A6D2C783AD87}"
          SendMailTask:From="noreply@roanoke.edu"
          SendMailTask:To="datamart@roanoke.edu"
          SendMailTask:CC="gabrielson@roanoke.edu"
          SendMailTask:Subject="Student Local Address Import Failure Hermes"
          SendMailTask:Priority="High"
          SendMailTask:MessageSource="Task:&#xA;&#xA;Merge Local Address &#xA;&#xA;in package StudentAddressImport located at &#xA;&#xA;StudentAddressImport.dtsx &#xA;&#xA;has failed.&#xA;&#xA;The import of student data into the datamart will continue.&#xA;&#xA;This step needs to be re-executed." xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Mailing Address Merge Error Notification"
      DTS:CreationName="Microsoft.SendMailTask"
      DTS:Description="Send Mail Task"
      DTS:DTSID="{4B2C4C58-DC23-4F72-AE7E-34103872311D}"
      DTS:ExecutableType="Microsoft.SendMailTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Mailing Address Merge Error Notification"
      DTS:TaskContact="Send Mail Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SendMailTask:SendMailTaskData
          SendMailTask:SMTPServer="{AA490B9E-F51F-4E17-8A18-A6D2C783AD87}"
          SendMailTask:From="noreply@roanoke.edu"
          SendMailTask:To="datamart@roanoke.edu"
          SendMailTask:CC="gabrielson@roanoke.edu"
          SendMailTask:Subject="Student Home Address Import Failure Hermes"
          SendMailTask:Priority="High"
          SendMailTask:MessageSource="Task:&#xA;&#xA;Merge Mailing Address &#xA;&#xA;in package StudentAddressImport located at &#xA;&#xA;StudentAddressImport.dtsx &#xA;&#xA;has failed.&#xA;&#xA;The import of student data into the datamart will continue.&#xA;&#xA;This step needs to be re-executed." xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Merge Home Address"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{9C5C015D-41B6-44E2-8882-2AC21BD72900}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Merge Home Address"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="2">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{101FB509-069B-4917-A8F6-460109941DEC}"
          SQLTask:SqlStatementSource="DECLARE @KeyAddressTypeId as int&#xA;&#xA;SELECT @KeyAddressTypeId = key_AddressTypeId&#xA;FROM DataMart.dbo.AddressType&#xA;Where Description = 'Home'&#xA;&#xA;&#xA;&#xA;MERGE Datamart.dbo.Address AS Target&#xA;USING (SELECT RCID&#xA; FROM Staging.dbo.DM_Student) AS Source&#xA;ON (Target.rcid = Source.rcid and Target.fkey_AddressTypeId = @keyAddressTypeId)&#xA;WHEN MATCHED THEN&#xA;   Delete;&#xA;&#xA;&#xA;MERGE Datamart.dbo.Address AS Target&#xA;USING (SELECT RCID, HomeAddress1, HomeAddress2, HomeCity, &#xA;  (SELECT key_StateId FROM Datamart.dbo.States&#xA;   WHERE STateCode = HomeState) as HomeStateKey, HomeZip&#xA; FROM Staging.dbo.DM_Student where homeaddress1 is not null AND&#xA;&#x9;len(rtrim(HomeAddress1)) &gt; 0) AS Source&#xA;ON (Target.rcid = Source.rcid and Target.fkey_AddressTypeId = @keyAddressTypeId)&#xA;WHEN MATCHED THEN&#xA;    UPDATE SET Target.Address1 = Source.HomeAddress1, Target.Address2 = Source.HomeAddress2, Target.City = Source.HomeCity,&#xA;  Target.fkey_stateId = Source.HomeStateKey, Target.PostalCode = Source.HomeZip&#xA;  &#xA;WHEN NOT MATCHED BY TARGET THEN&#xA;    INSERT (rcid, Address1, Address2, City, fkey_StateId, PostalCode, fkey_AddressTypeId)&#xA;   &#xA;    VALUES (Source.rcid, Source.HomeAddress1, Source.HomeAddress2, Source.HomeCity, &#xA;  Source.HomeStateKey, Source.HomeZip, @KeyAddressTypeId);&#xA;  &#xA;  &#xA;  &#xA;   &#xA; &#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Merge Local Address"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{217B043D-6EC8-4A21-A688-AAA75142CDB1}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Merge Local Address"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{101FB509-069B-4917-A8F6-460109941DEC}"
          SQLTask:SqlStatementSource="DECLARE @KeyAddressTypeId as int&#xA;&#xA;SELECT @KeyAddressTypeId = key_AddressTypeId&#xA;FROM DataMart.dbo.AddressType&#xA;Where Description = 'Local'&#xA;&#xA;&#xA;&#xA;MERGE Datamart.dbo.Address AS Target&#xA;USING (SELECT RCID&#xA; FROM Staging.dbo.DM_Student) AS Source&#xA;ON (Target.rcid = Source.rcid and Target.fkey_AddressTypeId = @keyAddressTypeId)&#xA;WHEN MATCHED THEN&#xA;   Delete;&#xA;&#xA;MERGE Datamart.dbo.Address AS Target&#xA;USING (SELECT RCID, LocalAddress1, LocalAddress2, LocalCity, &#xA;  (SELECT key_StateId FROM Datamart.dbo.States&#xA;   WHERE STateCode = LocalState) as LocalStateKey, LocalZip&#xA; FROM Staging.dbo.DM_Student Where localaddress1 is not null AND len(rtrim(LocalAddress1)) &gt; 0) as Source&#xA;ON (Target.rcid = Source.rcid and Target.fkey_AddressTypeId = @keyAddressTypeId)&#xA;WHEN MATCHED THEN&#xA;    UPDATE SET Target.Address1 = Source.LocalAddress1, Target.Address2 = Source.LocalAddress2, Target.City = Source.LocalCity,&#xA;  Target.fkey_stateId = Source.LocalStateKey, Target.PostalCode = Source.LocalZip&#xA;  &#xA;WHEN NOT MATCHED BY TARGET THEN&#xA;    INSERT (rcid, Address1, Address2, City, fkey_StateId, PostalCode, fkey_AddressTypeId)&#xA;   &#xA;    VALUES (Source.rcid, Source.LocalAddress1, Source.LocalAddress2, Source.LocalCity, &#xA;  Source.LocalStateKey, Source.LocalZip, @KeyAddressTypeId);&#xA;   " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Merge mailing Address"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{C0630F33-5C6D-4A56-BFF5-A3EA2EC491F9}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Merge mailing Address"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{101FB509-069B-4917-A8F6-460109941DEC}"
          SQLTask:SqlStatementSource="DECLARE @KeyAddressTypeId as int&#xA;&#xA;SELECT @KeyAddressTypeId = key_AddressTypeId&#xA;FROM DataMart.dbo.AddressType&#xA;Where Description = 'Mailing'&#xA;&#xA;&#xA;&#xA;MERGE Datamart.dbo.Address AS Target&#xA;USING (SELECT RCID&#xA; FROM Staging.dbo.DM_Student) AS Source&#xA;ON (Target.rcid = Source.rcid and Target.fkey_AddressTypeId = @keyAddressTypeId)&#xA;WHEN MATCHED THEN&#xA;   Delete;&#xA;&#xA;&#xA;MERGE Datamart.dbo.Address AS Target&#xA;USING (SELECT RCID, Box, &#xA;  (SELECT key_StateId FROM Datamart.dbo.States&#xA;   WHERE STateCode = 'VA') as MailingStateKey&#xA; FROM Staging.dbo.DM_Student Where Box is not null and len(rtrim(Box)) &gt; 0) AS Source&#xA;ON (Target.rcid = Source.rcid and Target.fkey_AddressTypeId = @keyAddressTypeId)&#xA;WHEN MATCHED THEN&#xA;    UPDATE SET Target.Address1 = 'Roanoke College', &#xA;    Target.Address2 = 'Campus ' + rtrim(Source.Box),&#xA;     Target.City = 'Salem',&#xA;  Target.fkey_stateId = Source.MailingStateKey, Target.PostalCode = '24153'&#xA;  &#xA;WHEN NOT MATCHED BY TARGET THEN&#xA;    INSERT (rcid, Address1, Address2, City, fkey_StateId, PostalCode, fkey_AddressTypeId)&#xA;   &#xA;    VALUES (Source.rcid, 'Roanoke College', 'Campus ' + rtrim(Source.box), 'Salem', &#xA;  Source.MailingStateKey, '24153', @KeyAddressTypeId);&#xA; " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{73ACA045-5225-4550-B20C-17242BD863F7}"
      DTS:From="Package\Merge Home Address"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Home Address Merge Error Notification"
      DTS:Value="1" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{1F654C6F-8730-4BD5-B605-801559ED3639}"
      DTS:From="Package\Merge Local Address"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Local Address Merge Error Notification"
      DTS:Value="1" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{C3682438-A73F-4977-A665-937CA2CB1EF0}"
      DTS:From="Package\Merge mailing Address"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\Mailing Address Merge Error Notification"
      DTS:Value="1" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="sql12">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="136,94"
          Id="Package\Home Address Merge Error Notification"
          TopLeft="17.3867924528302,156.179245283019" />
        <NodeLayout
          Size="136,99"
          Id="Package\Local Address Merge Error Notification"
          TopLeft="211.198113207547,141.047169811321" />
        <NodeLayout
          Size="136,94"
          Id="Package\Mailing Address Merge Error Notification"
          TopLeft="441.801886792453,169.990566037736" />
        <NodeLayout
          Size="204,44"
          Id="Package\Merge Home Address"
          TopLeft="5.5,5.5" />
        <NodeLayout
          Size="136,44"
          Id="Package\Merge Local Address"
          TopLeft="255.122641509434,19.5" />
        <NodeLayout
          Size="136,44"
          Id="Package\Merge mailing Address"
          TopLeft="461.801886792453,31.4622641509434" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="107.311320754717,49.4245283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-22.0377358490566,106.754716981132"
              Start="0,0"
              End="-22.0377358490566,99.2547169811321">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,53.3584905660377" />
                  <mssgle:LineSegment
                    End="-22.0377358490566,53.3584905660377" />
                  <mssgle:LineSegment
                    End="-22.0377358490566,99.2547169811321" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-26.2602155807783,58.3584905660377,30.4826953125,9.7490234375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="323.009433962264,63.4245283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-43.9245283018868,77.622641509434"
              Start="0,0"
              End="-43.9245283018868,70.122641509434">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,38.7924528301887" />
                  <mssgle:LineSegment
                    End="-43.9245283018868,38.7924528301887" />
                  <mssgle:LineSegment
                    End="-43.9245283018868,70.122641509434" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-37.2036118071934,43.7924528301887,30.4826953125,9.7490234375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="529.688679245283,75.3867924528302">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-19.9999999999999,94.6037735849057"
              Start="0,0"
              End="-19.9999999999999,87.1037735849057">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,47.2830188679245" />
                  <mssgle:LineSegment
                    End="-19.9999999999999,47.2830188679245" />
                  <mssgle:LineSegment
                    End="-19.9999999999999,87.1037735849057" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-25.24134765625,52.2830188679245,30.4826953125,9.7490234375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>